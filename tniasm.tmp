Main.s1FNAME "msx-wings.rom" 3START_ADDR_MEGAROM_PAGE: equ 0x80004PAGE_SIZE: equ 0x4000 5Seg_P8000_SW: equ 0x7000 81112 org 0x4000, 0xbeff 14 15 Include/RomHeader.s12 db "AB" 3 dw Execute 4 dw 0 6 dw 0 8 dw 0 9 dw 0, 0, 0 10 11Main.s16 Include/MsxBios.s189BIOS_HWVER: equ 0x002d1112BIOS_CGTABL: equ 0x0004 13BIOS_VDP_DR: equ 0x0006 14BIOS_VDP_DW: equ 0x0007 1617BIOS_CHKRAM: equ 0x000018BIOS_SYNCHR: equ 0x000819BIOS_RDSLT: equ 0x000c20BIOS_CHRGTR: equ 0x001021BIOS_WRSLT: equ 0x001422BIOS_OUTDO: equ 0x001823BIOS_CALSLT: equ 0x001c24BIOS_DCOMPR: equ 0x002025BIOS_ENASLT: equ 0x002426BIOS_GETYPR: equ 0x002827BIOS_CALLF: equ 0x003028BIOS_KEYINT: equ 0x00383031BIOS_INITIO: equ 0x003b32BIOS_INIFNK: equ 0x003e3435BIOS_DISSCR: equ 0x004136BIOS_ENASCR: equ 0x004437BIOS_WRTVDP: equ 0x004738BIOS_RDVRM: equ 0x004a39BIOS_WRTVRM: equ 0x004d40BIOS_SETRD: equ 0x005041BIOS_SETWRT: equ 0x005342BIOS_FILVRM: equ 0x005643BIOS_LDIRMV: equ 0x005944BIOS_LDIRVM: equ 0x005c45BIOS_CHGMOD: equ 0x005f46BIOS_CHGCLR: equ 0x006247BIOS_NMI: equ 0x006648BIOS_CLRSPR: equ 0x006949BIOS_INITXT: equ 0x006c50BIOS_INIT32: equ 0x006f51BIOS_INIGRP: equ 0x007252BIOS_INIMLT: equ 0x007553BIOS_SETTXT: equ 0x007854BIOS_SETT32: equ 0x007b55BIOS_SETGRP: equ 0x007e56BIOS_SETMLT: equ 0x008157BIOS_CALPAT: equ 0x008458BIOS_CALATR: equ 0x008759BIOS_GSPSIZ: equ 0x008a60BIOS_GRPPRT: equ 0x008d6263BIOS_GICINI: equ 0x009064BIOS_WRTPSG: equ 0x009365BIOS_RDPSG: equ 0x009666BIOS_STRTMS: equ 0x00996869BIOS_CHSNS: equ 0x009c70BIOS_CHGET: equ 0x009f71BIOS_CHPUT: equ 0x00a272BIOS_LPTOUT: equ 0x00a573BIOS_LPTSTT: equ 0x00a874BIOS_CNVCHR: equ 0x00ab75BIOS_PINLIN: equ 0x00ae76BIOS_INLIN: equ 0x00b177BIOS_QINLIN: equ 0x00b478BIOS_BREAKX: equ 0x00b779BIOS_BEEP: equ 0x00c080BIOS_CLS: equ 0x00c381BIOS_POSIT: equ 0x00c682BIOS_FNKSB: equ 0x00c983BIOS_ERAFNK: equ 0x00cc84BIOS_DSPFNK: equ 0x00cf85BIOS_TOTEXT: equ 0x00d28788BIOS_GTSTCK: equ 0x00d589BIOS_GTTRIG: equ 0x00d890BIOS_GTPAD: equ 0x00db91BIOS_GTPDL: equ 0x00de9394BIOS_TAPION: equ 0x00e195BIOS_TAPIN: equ 0x00e496BIOS_TAPIOF: equ 0x00e797BIOS_TAPOON: equ 0x00ea98BIOS_TAPOUT: equ 0x00ed99BIOS_TAPOOF: equ 0x00f0100BIOS_STMOTR: equ 0x00f3102103BIOS_CHGCAP: equ 0x0132104BIOS_CHGSND: equ 0x0135105BIOS_RSLREG: equ 0x0138106BIOS_WSLREG: equ 0x013b107BIOS_RDVDP: equ 0x013e108BIOS_SNSMAT: equ 0x0141109BIOS_PHYDIO: equ 0x0144110BIOS_ISFLIO: equ 0x014a111BIOS_OUTDLP: equ 0x014d112BIOS_KILBUF: equ 0x0156113BIOS_CALBAS: equ 0x0159115116BIOS_SUBROM: equ 0x015c117BIOS_EXTROM: equ 0x015f118BIOS_EOL: equ 0x0168119BIOS_BIGFIL: equ 0x016b120BIOS_NSETRD: equ 0x016e121BIOS_NSTWRT: equ 0x0171122BIOS_NRDVRM: equ 0x0174123BIOS_NWRVRM: equ 0x0177125126BIOS_GRPRT: equ 0x0089127BIOS_NVBXLN: equ 0x00c9128BIOS_NVBXFL: equ 0x00cd129BIOS_CLSSUB: equ 0x0115130BIOS_VDPSTA: equ 0x0131131BIOS_SETPAG: equ 0x013d132BIOS_INIPLT: equ 0x0141133BIOS_RSTPLT: equ 0x0145134BIOS_GETPLT: equ 0x0149135BIOS_SETPLT: equ 0x014d136BIOS_PROMPT: equ 0x0181137BIOS_NEWPAD: equ 0x01ad138BIOS_CHGMDP: equ 0x01b5139BIOS_KNJPRT: equ 0x01bd140BIOS_REDCLK: equ 0x01f5141BIOS_WRTCLK: equ 0x01f9143144BIOS_RDPRIM: equ 0xf380145BIOS_WRPRIM: equ 0xf385146BIOS_CLPRIM: equ 0xf38c148149BIOS_USRTAB: equ 0xf39a150BIOS_LINL40: equ 0xf3ae151BIOS_LINL32: equ 0xf3af152BIOS_LINLEN: equ 0xf3b0153BIOS_CRTCNT: equ 0xf3b1154BIOS_CLMLST: equ 0xf3b2156157BIOS_TXTNAM: equ 0xf3b3158BIOS_TXTCOL: equ 0xf3b5159BIOS_TXTCGP: equ 0xf3b7160BIOS_TXTATR: equ 0xf3b9161BIOS_TXTPAT: equ 0xf3bb163164BIOS_T32NAM: equ 0xf3bd165BIOS_T32COL: equ 0xf3bf166BIOS_T32CGP: equ 0xf3c1167BIOS_T32ATR: equ 0xf3c3168BIOS_T32PAT: equ 0xf3c5170171BIOS_GRPNAM: equ 0xf3c7172BIOS_GRPCOL: equ 0xf3c9173BIOS_GRPCGP: equ 0xf3cb174BIOS_GRPATR: equ 0xf3cd175BIOS_GRPPAT: equ 0xf3cf177178BIOS_MLTNAM: equ 0xf3d1179BIOS_MLTCOL: equ 0xf3d3180BIOS_MLTCGP: equ 0xf3d5181BIOS_MLTATR: equ 0xf3d7182BIOS_MLTPAT: equ 0xf3d9184185BIOS_CLIKSW: equ 0xf3db186BIOS_CSRY: equ 0xf3dc187BIOS_CSRX: equ 0xf3dd188BIOS_CNSDFG: equ 0xf3de190191BIOS_RG0SAV: equ 0xf3df192BIOS_RG1SAV: equ 0xf3e0193BIOS_RG2SAV: equ 0xf3e1194BIOS_RG3SAV: equ 0xf3e2195BIOS_RG4SAV: equ 0xf3e3196BIOS_RG5SAV: equ 0xf3e4197BIOS_RG6SAV: equ 0xf3e5198BIOS_RG7SAV: equ 0xf3e6199BIOS_RG8SAV: equ 0xffe7200BIOS_RG9SAV: equ 0xffe8201BIOS_STATFL: equ 0xf3e7202BIOS_TRGFLG: equ 0xf3e8203BIOS_FORCLR: equ 0xf3e9204BIOS_BAKCLR: equ 0xf3ea205BIOS_BDRCLR: equ 0xf3eb206BIOS_MAXUPD: equ 0xf3ec207BIOS_MINUPD: equ 0xf3ef208BIOS_ATRBYT: equ 0xf3f2210211BIOS_QUEUES: equ 0xf3f3212BIOS_FRCNEW: equ 0xf3f5214215BIOS_SCNCNT: equ 0xf3f6216BIOS_REPCNT: equ 0xf3f7217BIOS_PUTPNT: equ 0xf3f8218BIOS_GETPNT: equ 0xf3fa220221BIOS_CS120: equ 0xf3fc222BIOS_LOW: equ 0xf406223BIOS_HIGH: equ 0xf408224BIOS_HEADER: equ 0xf40a225BIOS_ASPCT1: equ 0xf40b226BIOS_ASPCT2: equ 0xf40d227BIOS_ENDPRG: equ 0xf40f229230BIOS_ERRFLG: equ 0xf414231BIOS_LPTPOS: equ 0xf415232BIOS_PRTFLG: equ 0xf416233BIOS_NTMSXP: equ 0xf417234BIOS_RAWPRT: equ 0xf418235BIOS_VLZADR: equ 0xf419236BIOS_VLZDAT: equ 0xf41b237BIOS_CURLIN: equ 0xf41c238BIOS_KBUF: equ 0xf41f239BIOS_BUFMIN: equ 0xf55d240BIOS_BUF: equ 0xf55e241BIOS_ENDBUF: equ 0xf660242BIOS_TTYPOS: equ 0xf661243BIOS_DIMFLG: equ 0xf662244BIOS_VALTYP: equ 0xf663245BIOS_DORES: equ 0xf664246BIOS_DONUM: equ 0xf665247BIOS_CONTXT: equ 0xf666248BIOS_CONSAV: equ 0xf668249BIOS_CONTYP: equ 0xf669250BIOS_CONLO: equ 0xf66a251BIOS_MEMSIZ: equ 0xf672252BIOS_STKTOP: equ 0xf674253BIOS_TXTTAB: equ 0xf676254BIOS_TEMPPT: equ 0xf768255BIOS_TEMPST: equ 0xf67a256BIOS_DSCTMP: equ 0xf698257BIOS_FRETOP: equ 0xf69b258BIOS_TEMP3: equ 0xf69d259BIOS_TEMP8: equ 0xf69f260BIOS_ENDFOR: equ 0xf6a1261BIOS_SUBFLG: equ 0xf6a5262BIOS_FLGINP: equ 0xf6a6263BIOS_TEMP: equ 0xf6a7264BIOS_PTRFLG: equ 0xf6a9265BIOS_AUTFLG: equ 0xf6aa266BIOS_AUTLIN: equ 0xf6ab267BIOS_AUTINC: equ 0xf6ad268BIOS_SAVTXT: equ 0xf6af269BIOS_ERRLIN: equ 0xf6b3270BIOS_DOT: equ 0xf6b5271BIOS_ERRTXT: equ 0xf6b7272BIOS_ONELIN: equ 0xf6b9273BIOS_ONEFLG: equ 0xf6bb274BIOS_TEMP2: equ 0xf6bc275BIOS_OLDLIN: equ 0xf6be276BIOS_OLDTXT: equ 0xf6c0277BIOS_VARTAB: equ 0xf6c2278BIOS_ARYTAB: equ 0xf6c4279BIOS_STREND: equ 0xf6c6280BIOS_DATPTR: equ 0xf6c8281BIOS_DEFTBL: equ 0xf6ca282BIOS_PRMSTK: equ 0xf6e4283BIOS_PRMLEN: equ 0xf6e6284BIOS_PARM1: equ 0xf6e8285BIOS_PRMPRV: equ 0xf74c286BIOS_PRMLN2: equ 0xf74e287BIOS_PARM2: equ 0xf750288BIOS_PRMFLG: equ 0xf7b4289BIOS_ARYTA2: equ 0xf7b5290BIOS_NOFUNS: equ 0xf7b7291BIOS_TEMP9: equ 0xf7b8292BIOS_FUNACT: equ 0xf7ba293BIOS_SWPTMP: equ 0xf7bc294BIOS_TRCFLG: equ 0xf7c4296297BIOS_FBUFFR: equ 0xf7c5298BIOS_DECTMP: equ 0xf7f0299BIOS_DECTM2: equ 0xf7f2300BIOS_DECCNT: equ 0xf7f4301BIOS_DAC: equ 0xf7f6302BIOS_HOLD8: equ 0xf806303BIOS_HOLD2: equ 0xf836304BIOS_HOLD: equ 0xf83e305BIOS_ARG: equ 0xf847306BIOS_RNDX: equ 0xf857308309BIOS_USRDATA: equ 0xf7f8311312BIOS_MAXFIL: equ 0xf85f313BIOS_FILTAB: equ 0xf860314BIOS_NULBUF: equ 0xf862315BIOS_PTRFIL: equ 0xf864316BIOS_RUNFLG: equ 0xf866317BIOS_FILNAM: equ 0xf866318BIOS_FILNM2: equ 0xf871319BIOS_NLONLY: equ 0xf87c320BIOS_SAVEND: equ 0xf87d321BIOS_FNKSTR: equ 0xf87f322BIOS_CGPNT: equ 0xf91f323BIOS_NAMBAS: equ 0xf922324BIOS_CGPBAS: equ 0xf924325BIOS_PATBAS: equ 0xf926326BIOS_ATRBAS: equ 0xf928327BIOS_CLOC: equ 0xf92a328BIOS_CMASK: equ 0xf92c329BIOS_MINDEL: equ 0xf92d330BIOS_MAXDEL: equ 0xf92f332333BIOS_ASPECT: equ 0xf931334BIOS_CENCNT: equ 0xf933335BIOS_CLINEF: equ 0xf935336BIOS_CNPNTS: equ 0xf936337BIOS_CPLOTF: equ 0xf938338BIOS_CPCNT: equ 0xf939339BIOS_CPNCNT8: equ 0xf93b340BIOS_CPCSUM: equ 0xf93d341BIOS_CSTCNT: equ 0xf93f342BIOS_CSCLXY: equ 0xf941343BIOS_CSAVEA: equ 0xf942344BIOS_CSAVEM: equ 0xf944345BIOS_CXOFF: equ 0xf945346BIOS_CYOFF: equ 0xf947348349BIOS_LOHMSK: equ 0xf949350BIOS_LOHDIR: equ 0xf94a351BIOS_LOHADR: equ 0xf94b352BIOS_LOHCNT: equ 0xf94d353BIOS_SKPCNT: equ 0xf94f354BIOS_MIVCNT: equ 0xf951355BIOS_PDIREC: equ 0xf953356BIOS_LFPROG: equ 0xf954357BIOS_RTPROG: equ 0xf955359360BIOS_MCLTAB: equ 0xf956361BIOS_MCLFLG: equ 0xf958362BIOS_QUETAB: equ 0xf959363BIOS_QUEBAK: equ 0xf971364BIOS_VOICAQ: equ 0xf975365BIOS_VOICBQ: equ 0xf9f5366BIOS_VOICCQ: equ 0xfa75368369BIOS_DPPAGE: equ 0xfaf5370BIOS_ACPAGE: equ 0xfaf6371BIOS_AVCSAV: equ 0xfaf7372BIOS_EXBRSA: equ 0xfaf8373BIOS_CHRCNT: equ 0xfaf9374BIOS_ROMA: equ 0xfafa375BIOS_MODE: equ 0xfafc376BIOS_NORUSE: equ 0xfafd377BIOS_XSAVE: equ 0xfafe378BIOS_YSAVE: equ 0xfb00379BIOS_LOGOPR: equ 0xfb02381382BIOS_RSTMP: equ 0xfb03383BIOS_TOCNT: equ 0xfb03384BIOS_RSFCB: equ 0xfb04385BIOS_RSIQLN: equ 0xfb06386BIOS_MEXBIH: equ 0xfb07387BIOS_OLDSTT: equ 0xfb0c388BIOS_OLDINT: equ 0xfb12389BIOS_DEVNUM: equ 0xfb17390BIOS_DATCNT: equ 0xfb18391BIOS_ERRORS: equ 0xfb1b392BIOS_FLAGS: equ 0xfb1c393BIOS_ESTBLS: equ 0xfb1d394BIOS_COMMSK: equ 0xfb1e395BIOS_LSTCOM: equ 0xfb1f396BIOS_LSTMOD: equ 0xfb20398399BIOS_PRSCNT: equ 0xfb35400BIOS_SAVSP: equ 0xfb36401BIOS_VOICEN: equ 0xfb38402BIOS_SAVVOL: equ 0xfb39403BIOS_MCLLEN: equ 0xfb3b404BIOS_MCLPTR: equ 0xfb3c405BIOS_QUEUEN: equ 0xfb3e406BIOS_MUSICF: equ 0xfc3f407BIOS_PLYCNT: equ 0xfb40409410BIOS_VCBA: equ 0xfb41411BIOS_VCBB: equ 0xfb66412BIOS_VCBC: equ 0xfb8b414415BIOS_ENSTOP: equ 0xfbb0416BIOS_BASROM: equ 0xfbb1417BIOS_LINTTB: equ 0xfbb2418BIOS_FSTPOS: equ 0xfbca419BIOS_CODSAV: equ 0xfbcc420BIOS_FNKSW1: equ 0xfbcd421BIOS_FNKFLG: equ 0xfbce422BIOS_ONGSBF: equ 0xfbd8423BIOS_CLIKFL: equ 0xfbd9424BIOS_OLDKEY: equ 0xfbda425BIOS_NEWKEY: equ 0xfbe5426BIOS_KEYBUF: equ 0xfbf0427BIOS_LINWRK: equ 0xfc18428BIOS_PATWRK: equ 0xfc40429BIOS_BOTTOM: equ 0xfc48430BIOS_HIMEM: equ 0xfc4a431BIOS_TRAPTBL: equ 0xfc4c432BIOS_RTYCNT: equ 0xfc9a433BIOS_INTFLG: equ 0xfc9b434BIOS_PADY: equ 0xfc9c435BIOS_PADX: equ 0xfc9d436BIOS_JIFFY: equ 0xfc9e437BIOS_INTVAL: equ 0xfca0438BIOS_INTCNT: equ 0xfca2439BIOS_LOWLIM: equ 0xfca4440BIOS_WINWID: equ 0xfca5441BIOS_GRPHED: equ 0xfca6442BIOS_ESCCNT: equ 0xfca7443BIOS_INSFLG: equ 0xfca8444BIOS_CSRSW: equ 0xfca9445BIOS_CSTYLE: equ 0xfcaa446BIOS_CAPST: equ 0xfcab447BIOS_KANAST: equ 0xfcac448BIOS_KANAMD: equ 0xfcad449BIOS_FLBMEM: equ 0xfcae450BIOS_SCRMOD: equ 0xfcaf451BIOS_OLDSCR: equ 0xfcb0452BIOS_CASPRV: equ 0xfcb1453BIOS_BRDATR: equ 0xfcb2454BIOS_GXPOS: equ 0xfcb3455BIOS_GYPOS: equ 0xfcb5456BIOS_GRPACX: equ 0xfcb7457BIOS_GRPACY: equ 0xfcb9458BIOS_DRWFLG: equ 0xfcbb459BIOS_DRWSCL: equ 0xfcbc460BIOS_DRWANG: equ 0xfcbd461BIOS_RUNBNF: equ 0xfcbe462BIOS_SAVENT: equ 0xfcbf463BIOS_ROMSLT: equ 0xfcc0464BIOS_EXPTBL: equ 0xfcc1465BIOS_SLTTBL: equ 0xfcc5466BIOS_SLTATR: equ 0xfcc9467BIOS_SLTWRK: equ 0xfd09468BIOS_PROCNM: equ 0xfd89469BIOS_DEVICE: equ 0xfd99471472BIOS_H_KEYI: equ 0xfd9a473BIOS_H_TIMI: equ 0xfd9f474BIOS_H_CHPH: equ 0xfda4475BIOS_H_DSPC: equ 0xfda9476BIOS_H_ERAC: equ 0xfdae477BIOS_H_DSPF: equ 0xfdb3478BIOS_H_ERAF: equ 0xfdb8479BIOS_H_TOTE: equ 0xfdbd480BIOS_H_CHGE: equ 0xfdc2481BIOS_H_INIP: equ 0xfdc7482BIOS_H_KEYC: equ 0xfdcc483BIOS_H_KYEA: equ 0xfdd1484BIOS_H_NMI: equ 0xfdd6485BIOS_H_PINL: equ 0xfddb486BIOS_H_QINL: equ 0xfde0487BIOS_H_INLI: equ 0xfde5488BIOS_H_ONGO: equ 0xfdea489BIOS_H_DSKO: equ 0xfdef490BIOS_H_SETS: equ 0xfdf4491BIOS_H_NAME: equ 0xfdf9492BIOS_H_KILL: equ 0xfdfe493BIOS_H_IPL: equ 0xfe03494BIOS_H_COPY: equ 0xfe08495BIOS_H_CMD: equ 0xfe0d496BIOS_H_DSKF: equ 0xfe12497BIOS_H_DSKI: equ 0xfe17498BIOS_H_ATTR: equ 0xfe1c499BIOS_H_LSET: equ 0xfe21500BIOS_H_RSET: equ 0xfe26501BIOS_H_FIEL: equ 0xfe2b502BIOS_H_MKI: equ 0xfe30503BIOS_H_MKS: equ 0xfe35504BIOS_H_MKD: equ 0xfe3a505BIOS_H_CVI: equ 0xfe3f506BIOS_H_CVS: equ 0xfe44507BIOS_H_CVD: equ 0xfe49508BIOS_H_GETP: equ 0xfe4e509BIOS_H_SETF: equ 0xfe53510BIOS_H_NOFO: equ 0xfe58511BIOS_H_NULO: equ 0xfe5d512BIOS_H_NTFL: equ 0xfe62513BIOS_H_MERG: equ 0xfe67514BIOS_H_SAVE: equ 0xfe6c515BIOS_H_BINS: equ 0xfe71516BIOS_H_BINL: equ 0xfe76517BIOS_H_FILE: equ 0xfd7b518BIOS_H_DGET: equ 0xfe80519BIOS_H_FILO: equ 0xfe85520BIOS_H_INDS: equ 0xfe8a521BIOS_H_RSLF: equ 0xfe8f522BIOS_H_SAVD: equ 0xfe94523BIOS_H_LOC: equ 0xfe99524BIOS_H_LOF: equ 0xfe9e525BIOS_H_EOF: equ 0xfea3526BIOS_H_FPOS: equ 0xfea8527BIOS_H_BAKU: equ 0xfead528BIOS_H_PARD: equ 0xfeb2529BIOS_H_NODE: equ 0xfeb7530BIOS_H_POSD: equ 0xfebc531BIOS_H_DEVN: equ 0xfec1532BIOS_H_GEND: equ 0xfec6533BIOS_H_RUNC: equ 0xfecb534BIOS_H_CLEAR: equ 0xfed0535BIOS_H_LOPD: equ 0xfed5536BIOS_H_STKE: equ 0xfeda537BIOS_H_ISFL: equ 0xfedf538BIOS_H_OUTD: equ 0xfee4539BIOS_H_CRDO: equ 0xfee9540BIOS_H_DSKC: equ 0xfeee541BIOS_H_DOGR: equ 0xfef3542BIOS_H_PRGE: equ 0xfef8543BIOS_H_ERRP: equ 0xfefd544BIOS_H_ERRF: equ 0xff02545BIOS_H_READ: equ 0xff07546BIOS_H_MAIN: equ 0xff0c547BIOS_H_DIRD: equ 0xff11548BIOS_H_FINI: equ 0xff16549BIOS_H_FINE: equ 0xff1b550BIOS_H_CRUN: equ 0xff20551BIOS_H_CRUS: equ 0xff25552BIOS_H_ISRE: equ 0xff2a553BIOS_H_NTFN: equ 0xff2f554BIOS_H_NOTR: equ 0xff34555BIOS_H_SNGF: equ 0xff39556BIOS_H_NEWS: equ 0xff3e557BIOS_H_GONE: equ 0xff43558BIOS_H_CHRG: equ 0xff48559BIOS_H_RETU: equ 0xff4d560BIOS_H_PRTF: equ 0xff52561BIOS_H_COMP: equ 0xff57562BIOS_H_FINP: equ 0xff5c563BIOS_H_TRMN: equ 0xff61564BIOS_H_FRME: equ 0xff66565BIOS_H_NTPL: equ 0xff6b566BIOS_H_EVAL: equ 0xff70567BIOS_H_OKNO: equ 0xff75568BIOS_H_FING: equ 0xff7a569BIOS_H_ISMI: equ 0xff7f570BIOS_H_WIDT: equ 0xff84571BIOS_H_LIST: equ 0xff89572BIOS_H_BUFL: equ 0xff8e573BIOS_H_FRQI: equ 0xff93574BIOS_H_SCNE: equ 0xff98575BIOS_H_FRET: equ 0xff9d576BIOS_H_PTRG: equ 0xffa2577BIOS_H_PHYD: equ 0xffa7578BIOS_H_FORM: equ 0xffac579BIOS_H_ERRO: equ 0xffb1580BIOS_H_LPTO: equ 0xffb6581BIOS_H_LPTS: equ 0xffbb582BIOS_H_SCRE: equ 0xffc0583BIOS_H_PLAY: equ 0xffc5585586BIOS_FCALL: equ 0xffca587BIOS_DISINT: equ 0xffcf588BIOS_ENAINT: equ 0xffd4592597598HKEYI: equ $fd9a 599HTIMI: equ $fd9f 601HOOK_SIZE: equ HTIMI - HKEYI604605MSXID1: equ $002b 609MSXID2: equ $002c 612MSXID3: equ $002d 617MSXID4: equ $002e 618MSXID5: equ $002f 619Main.s17 Include/MsxConstants.s1PORT_0: equ 0x982PORT_1: equ 0x993PORT_2: equ 0x9a4PORT_3: equ 0x9b78REG1SAV: equ 0xF3E010REG8SAV: equ 0xFFE711REG9SAV: equ 0xFFE812Main.s18 Include/CommonRoutines.s145ClearRam:6 ld hl, RamStart 7 ld de, RamEnd + 1 9.loop:10 xor a 11 ld (hl), a13 inc hl14 call BIOS_DCOMPR 15 ret z16 jp .loop2024SetPaletteColor:25 push bc26 27 ld b, a 28 ld c, 16 29 call BIOS_WRTVDP30 ld c, 0x9a 31 pop de33 ld a, d 34 di35 out (c), a36 ld a, e 37 ei38 out (c), a40 ret4445LoadPalette:46 47 ld b, 0 48 ld c, 16 49 call BIOS_WRTVDP50 ld c, PORT_2 52 ld b, 1653.loop:54 di55 ld a, (hl)56 out (c), a57 inc hl58 ld a, (hl)59 out (c), a60 ei61 inc hl62 djnz .loop63 64 ret6869EnableRomPage2:7072 call BIOS_RSLREG73 rrca74 rrca75 and 3 76 ld c,a77 ld b,078 ld hl, BIOS_EXPTBL79 add hl,bc80 ld a,(hl)81 and 80h82 or c83 ld c,a84 inc hl85 inc hl86 inc hl87 inc hl88 ld a,(hl)89 and 0Ch90 or c91 ld h,080h92 call BIOS_ENASLT 94 ret97101Wait_B_Vblanks:102 103 push bc104 105 .loop:107 ld a, (BIOS_JIFFY)108 ld c, a109 .waitVBlank:110 ld a, (BIOS_JIFFY)111 cp c112 jp z, .waitVBlank114 djnz .loop115 116 pop bc118 ret120Wait:121 ld c, 15123 .loop:124 ld a, (BIOS_JIFFY)125 ld b, a126 .waitVBlank:127 ld a, (BIOS_JIFFY)128 cp b129 jp z, .waitVBlank131 dec c132 jp nz, .loop134138SetVdp_Write:139 rlc h140 rla141 rlc h142 rla143 srl h144 srl h145 di146 out (PORT_1), a147 ld a, 14 + 128148 out (PORT_1), a149 ld a, l150 nop151 out (PORT_1), a152 ld a, h153 or 64154 ei155 out (PORT_1), a156 ret158162SetVdp_Read:163 rlc h164 rla165 rlc h166 rla167 srl h168 srl h169 di170 out (PORT_1),a171 ld a,14 + 128172 out (PORT_1),a173 ld a,l174 nop175 out (PORT_1),a176 ld a,h177 ei178 out (PORT_1),a179 ret182190211 212214216218220225233241244ClearVram_MSX2:245 xor a 246 ld hl, 0 247 call SetVDP_Write249259 xor a261 263 264 ld d, 2 265.loop_2:266 ld c, 0 267.loop_1:268 ld b, 0 269.loop:270 out (PORT_0), a271 djnz .loop272 dec c273 jp nz, .loop_1274 dec d275 jp nz, .loop_2277 ret280Screen11:281 283 ld a, 8284 call BIOS_CHGMOD285 ld b, 0001 1000 b 286 ld c, 25 287 call BIOS_WRTVDP288 ret290SetSprites16x16:291 ld a, (REG1SAV)292 or 0000 0010 b293 ld b, a294 ld c, 1 295 call BIOS_WRTVDP296 ret298Set192Lines:299 303 ld a, (REG9SAV)304 and 0111 1111 b305 ld b, a306 ld c, 9 307 call BIOS_WRTVDP308 ret310SetColor0ToTransparent:311 315 ld a, (REG8SAV)316 and 1101 1111 b317 ld b, a318 ld c, 8 319 call BIOS_WRTVDP320 ret322326LDIRVM_MSX2:327 328 ex de, hl329 330 call SetVdp_Write331 ex de, hl332 ld d, c333 334 ld c, PORT_0 335 ld b, 0336.loop_1:337 otir338 dec d339 jp nz, .loop_1340 ret344362 371 375381CheckCollision_16x16_16x16:383 ld a, d 384 sub b 385 jr c, .x1IsLarger 386 sub 16 387 ret nc 388 jp .checkVerticalCollision389.x1IsLarger:390 neg 395 396 sub 16 397 ret nc 399.checkVerticalCollision:400 ld a, e 401 sub c 402 jr c, .y1IsLarger 403 sub 16 404 ret 405.y1IsLarger:406 neg 411 412 sub 16 413 ret 417422425435439442445450 451453460464466474 475483489496502505512518526528536543550553559561 563571576581585588599606611616619626631633639642644648652654657660663668 669672675 676681685688693 694697699 700705709713DoCopy:714 ld a, 32715 di716 out (PORT_1), a717 ld a, 17 + 128718 out (PORT_1), a719 ld c, 0x9B720.vdpReady:721 ld a, 2722 di723 out (PORT_1), a 724 ld a, 15 + 128725 out (PORT_1), a726 in a, (PORT_1)727 rra728 ld a, 0 729 out (PORT_1), a730 ld a, 15 + 128731 ei732 out (PORT_1), a 733 jp c, .vdpReady734 outi 735 outi 736 outi737 outi738 outi739 outi740 outi741 outi742 outi743 outi744 outi745 outi746 outi747 outi748 outi749 retMain.s20 21 InitVram.s1InitVram:3 4 ld a, 05 ld (BIOS_CLIKSW), a 7 8 ld a, 1 9 ld (BIOS_FORCLR), a 10 ld a, 1 11 ld (BIOS_BAKCLR), a 12 ld a, 1 13 ld (BIOS_BDRCLR), a 14 call BIOS_CHGCLR 16 call Screen1118 call BIOS_DISSCR20 call ClearVram_MSX222 call SetSprites16x1624 call Set192Lines26 call SetColor0ToTransparent28 3540 ld b, 1111 0111 b 41 ld c, 5 42 call BIOS_WRTVDP43 44 ld b, 0000 0011 b 45 ld c, 11 46 call BIOS_WRTVDP4853 ld b, 0011 1110 b 54 ld c, 6 55 call BIOS_WRTVDP57NAMTBL: equ 0x000058SPRPAT: equ 0xf000 59SPRCOL: equ 0xf80060SPRATR: equ 0xfa0065 ld hl, PaletteData66 call LoadPalette7072 73 ld a, 0000 0001 b74 ld hl, SPRPAT75 call SetVdp_Write76 ld b, SpritePattern_PlayerPlane_0_and_1.size77 ld c, PORT_0 78 ld hl, SpritePattern_PlayerPlane_0_and_179 otir81 82 ld a, 0000 0001 b83 ld hl, SPRPAT + 6484 call SetVdp_Write85 ld b, SpritePattern_PlayerPlane_2_and_3.size86 ld c, PORT_0 87 ld hl, SpritePattern_PlayerPlane_2_and_388 otir90 91 ld a, 0000 0001 b92 ld hl, SPRPAT + 12893 call SetVdp_Write94 ld b, SpritePattern_PlayerShot.size95 ld c, PORT_0 96 ld hl, SpritePattern_PlayerShot97 otir99 100 ld a, 0000 0001 b101 ld hl, SPRPAT + 128 + SpritePattern_PlayerShot.size102 call SetVdp_Write103 ld b, SpritePattern_EnemyPlane_0_and_1.size104 ld c, PORT_0 105 ld hl, SpritePattern_EnemyPlane_0_and_1106 otir108 109 ld a, 0000 0001 b110 ld hl, SPRPAT + 128 + SpritePattern_PlayerShot.size + SpritePattern_EnemyPlane_0_and_1.size111 call SetVdp_Write112 ld b, SpritePattern_Explosion_Frames_0_to_2.size113 ld c, PORT_0 114 ld hl, SpritePattern_Explosion_Frames_0_to_2115 otir117 118 ld a, 0000 0001 b119 ld hl, SPRPAT + 128 + SpritePattern_PlayerShot.size + SpritePattern_EnemyPlane_0_and_1.size + SpritePattern_Explosion_Frames_0_to_2.size120 call SetVdp_Write121 ld b, SpritePattern_EnemyShot_0_and_1.size122 ld c, PORT_0 123 ld hl, SpritePattern_EnemyShot_0_and_1124 otir127129 130 ld a, 0000 0001 b131 ld hl, SPRCOL132 call SetVdp_Write133 ld b, SpriteColors_PlayerPlane_0_and_1.size134 ld c, PORT_0 135 ld hl, SpriteColors_PlayerPlane_0_and_1136 otir138 139 ld a, 0000 0001 b140 ld hl, SPRCOL + 32141 call SetVdp_Write142 ld b, SpriteColors_PlayerPlane_2_and_3.size143 ld c, PORT_0 144 ld hl, SpriteColors_PlayerPlane_2_and_3145 otir147 148 ld a, 0000 0001 b149 ld hl, SPRCOL + 64150 call SetVdp_Write151 ld b, SpriteColors_PlayerShot.size152 ld c, PORT_0 153 ld hl, SpriteColors_PlayerShot154 otir156 157 ld a, 0000 0001 b158 ld hl, SPRCOL + 64 + 16159 call SetVdp_Write160 ld b, SpriteColors_PlayerShot.size161 ld c, PORT_0 162 ld hl, SpriteColors_PlayerShot163 otir165 166 ld a, 0000 0001 b167 ld hl, SPRCOL + 64 + 32168 call SetVdp_Write169 ld b, SpriteColors_PlayerShot.size170 ld c, PORT_0 171 ld hl, SpriteColors_PlayerShot172 otir174 175ENEMY_0_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 0)176ENEMY_1_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 1)177ENEMY_2_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 2)178ENEMY_3_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 3)179ENEMY_4_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 4)180ENEMY_5_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 5)181ENEMY_6_SPRCOL_ADDR: equ SPRCOL + 64 + 32 + 16 + (SpriteColors_EnemyPlane_0_and_1.size * 6)183 192 201 210 219 228 241 250252 259 264 ret266Main.s22 UpdateSpriteAttrTableBuffer.s1411PLAYER_SPR_PAT_0_NUMBER: equ 0 * 412PLAYER_SPR_PAT_1_NUMBER: equ 1 * 413PLAYER_SPR_PAT_2_NUMBER: equ 2 * 414PLAYER_SPR_PAT_3_NUMBER: equ 3 * 415PLAYER_SHOT_SPR_PAT_NUMBER: equ 4 * 416ENEMY_SPR_PAT_0_NUMBER: equ 5 * 417ENEMY_SPR_PAT_1_NUMBER: equ 6 * 418EXPLOSION_SPR_PAT_0_NUMBER: equ 7 * 419EXPLOSION_SPR_PAT_1_NUMBER: equ 8 * 420EXPLOSION_SPR_PAT_2_NUMBER: equ 9 * 421ENEMY_SHOT_SPR_PAT_0_NUMBER: equ 10 * 422ENEMY_SHOT_SPR_PAT_1_NUMBER: equ 11 * 423EMPTY_SPR_PAT_NUMBER: equ 63 * 425UpdateSpriteAttrTableBuffer:26 ld hl, SpriteAttrTableBuffer2931 32 ld a, (Player_Y)33 ld (hl), a35 inc hl36 ld a, (Player_X)37 ld (hl), a39 inc hl40 43 inc hl44 4749 50 inc hl51 ld a, (Player_Y)52 ld (hl), a54 inc hl55 ld a, (Player_X)56 ld (hl), a58 inc hl59 62 inc hl63 6668 69 inc hl70 ld a, (Player_Y)71 ld b, 1672 add a, b73 ld (hl), a75 inc hl76 ld a, (Player_X)77 ld (hl), a79 inc hl80 83 inc hl84 8789 90 inc hl91 ld a, (Player_Y)92 ld b, 1693 add a, b94 ld (hl), a96 inc hl97 ld a, (Player_X)98 ld (hl), a100 inc hl101 104 inc hl105 108110112 113 inc hl114 ld a, (PlayerShot_0_Struct + 2) 115 ld (hl), a117 inc hl118 ld a, (PlayerShot_0_Struct + 1) 119 ld (hl), a121 inc hl122 ld a, (PlayerShot_0_Struct) 123 or a124 ld a, PLAYER_SHOT_SPR_PAT_NUMBER125 jp nz, .sprite_4_continue 126 ld a, EMPTY_SPR_PAT_NUMBER127.sprite_4_continue:128 ld (hl), a130 inc hl132134 135 inc hl136 ld a, (PlayerShot_1_Struct + 2) 137 ld (hl), a139 inc hl140 ld a, (PlayerShot_1_Struct + 1) 141 ld (hl), a143 inc hl144 ld a, (PlayerShot_1_Struct) 145 or a146 ld a, PLAYER_SHOT_SPR_PAT_NUMBER147 jp nz, .sprite_5_continue 148 ld a, EMPTY_SPR_PAT_NUMBER149.sprite_5_continue:150 ld (hl), a152 inc hl154156 157 inc hl158 ld a, (PlayerShot_2_Struct + 2) 159 ld (hl), a161 inc hl162 ld a, (PlayerShot_2_Struct + 1) 163 ld (hl), a165 inc hl166 ld a, (PlayerShot_2_Struct) 167 or a168 ld a, PLAYER_SHOT_SPR_PAT_NUMBER169 jp nz, .sprite_6_continue 170 ld a, EMPTY_SPR_PAT_NUMBER171.sprite_6_continue:172 ld (hl), a174 inc hl176178180 181 inc hl182 ld a, (Enemy_0_Struct + 2) 183 ld (hl), a185 inc hl186 ld a, (Enemy_0_Struct + 1) 187 ld (hl), a189 inc hl190 ld a, (Enemy_0_Struct + 4) 191 ld (hl), a193 inc hl194 197199 200 inc hl201 ld a, (Enemy_0_Struct + 2) 202 ld (hl), a204 inc hl205 ld a, (Enemy_0_Struct + 1) 206 ld (hl), a208 inc hl209 ld a, (Enemy_0_Struct + 5) 210 ld (hl), a212 inc hl213 216218 219 inc hl220 ld a, (Enemy_1_Struct + 2) 221 ld (hl), a223 inc hl224 ld a, (Enemy_1_Struct + 1) 225 ld (hl), a227 inc hl228 ld a, (Enemy_1_Struct + 4) 229 ld (hl), a231 inc hl232 235237 238 inc hl239 ld a, (Enemy_1_Struct + 2) 240 ld (hl), a242 inc hl243 ld a, (Enemy_1_Struct + 1) 244 ld (hl), a246 inc hl247 ld a, (Enemy_1_Struct + 5) 248 ld (hl), a250 inc hl251 254256 257 inc hl258 ld a, (Enemy_2_Struct + 2) 259 ld (hl), a261 inc hl262 ld a, (Enemy_2_Struct + 1) 263 ld (hl), a265 inc hl266 ld a, (Enemy_2_Struct + 4) 267 ld (hl), a269 inc hl270 273275 276 inc hl277 ld a, (Enemy_2_Struct + 2) 278 ld (hl), a280 inc hl281 ld a, (Enemy_2_Struct + 1) 282 ld (hl), a284 inc hl285 ld a, (Enemy_2_Struct + 5) 286 ld (hl), a288 inc hl289 292294 295 inc hl296 ld a, (Enemy_3_Struct + 2) 297 ld (hl), a299 inc hl300 ld a, (Enemy_3_Struct + 1) 301 ld (hl), a303 inc hl304 ld a, (Enemy_3_Struct + 4) 305 ld (hl), a307 inc hl308 311313 314 inc hl315 ld a, (Enemy_3_Struct + 2) 316 ld (hl), a318 inc hl319 ld a, (Enemy_3_Struct + 1) 320 ld (hl), a322 inc hl323 ld a, (Enemy_3_Struct + 5) 324 ld (hl), a326 inc hl327 330332 333 inc hl334 ld a, (Enemy_4_Struct + 2) 335 ld (hl), a337 inc hl338 ld a, (Enemy_4_Struct + 1) 339 ld (hl), a341 inc hl342 ld a, (Enemy_4_Struct + 4) 343 ld (hl), a345 inc hl346 349351 352 inc hl353 ld a, (Enemy_4_Struct + 2) 354 ld (hl), a356 inc hl357 ld a, (Enemy_4_Struct + 1) 358 ld (hl), a360 inc hl361 ld a, (Enemy_4_Struct + 5) 362 ld (hl), a364 inc hl365 368370 371 inc hl372 ld a, (Enemy_5_Struct + 2) 373 ld (hl), a375 inc hl376 ld a, (Enemy_5_Struct + 1) 377 ld (hl), a379 inc hl380 ld a, (Enemy_5_Struct + 4) 381 ld (hl), a383 inc hl384 387389 390 inc hl391 ld a, (Enemy_5_Struct + 2) 392 ld (hl), a394 inc hl395 ld a, (Enemy_5_Struct + 1) 396 ld (hl), a398 inc hl399 ld a, (Enemy_5_Struct + 5) 400 ld (hl), a402 inc hl403 406408 409 inc hl410 ld a, (Enemy_6_Struct + 2) 411 ld (hl), a413 inc hl414 ld a, (Enemy_6_Struct + 1) 415 ld (hl), a417 inc hl418 ld a, (Enemy_6_Struct + 4) 419 ld (hl), a421 inc hl422 425427 428 inc hl429 ld a, (Enemy_6_Struct + 2) 430 ld (hl), a432 inc hl433 ld a, (Enemy_6_Struct + 1) 434 ld (hl), a436 inc hl437 ld a, (Enemy_6_Struct + 5) 438 ld (hl), a440 inc hl441 444448 retMain.s23 BlitSPRATR.s1BlitSPRATR:2 3 ld a, 0000 0001 b4 ld hl, SPRATR5 call SetVdp_Write6 9 ld c, PORT_010 ld hl, SpriteAttrTableBuffer11 13 outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi 14 outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi 15 outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi 16 outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi 18 retMain.s24 InitVariables.s1PLAYER_INITIAL_X: equ 128 - (PLANE_PLAYER_WIDTH/2)2PLAYER_INITIAL_Y: equ 192 - 324InitVariables:6 ld a, PLAYER_INITIAL_X7 ld (Player_X), a9 ld a, PLAYER_INITIAL_Y10 ld (Player_Y), a11 ld (Player_Y_Static), a14 ld hl, PlayerShot_0_Struct15 call PlayerShot_Reset16 ld hl, PlayerShot_1_Struct17 call PlayerShot_Reset18 ld hl, PlayerShot_2_Struct19 call PlayerShot_Reset20 28 ld hl, Enemy_0_Struct29 call Enemy_Reset30 ld hl, Enemy_1_Struct31 call Enemy_Reset32 ld hl, Enemy_2_Struct33 call Enemy_Reset34 ld hl, Enemy_3_Struct35 call Enemy_Reset36 ld hl, Enemy_4_Struct37 call Enemy_Reset38 ld hl, Enemy_5_Struct39 call Enemy_Reset40 ld hl, Enemy_6_Struct41 call Enemy_Reset44 45 ld hl, PlayerShot_0_Struct46 ld (NextShot_Struct_Addr), hl48 ld a, 25549 ld (Player_FramesSinceLastShot), a52 xor a53 ld (Screen_Y_Origin), a56 ld hl, 057 ld (LevelCounter), hl60 ld hl, Level_1_Data61 ld (LevelData_CurrentAddr), hl65 66 ld hl, InitialSpriteAttributes67 ld de, SpriteAttrTableBuffer68 ld bc, InitialSpriteAttributes.size69 ldir73 retMain.s25 Scroll.s1ADDR_LAST_LINE_OF_PAGE: equ 0x8000 + (63 * 256)35InitVariablesForScroll:6 8 ld (CurrentMegaROMPage), a9 ld hl, ADDR_LAST_LINE_OF_PAGE10 ld (CurrentAddrLineScroll), hl11 ld hl, 255 * 25612 ld (CurrentVRAMAddrLineScroll), hl14 15 xor a16 ld (VerticalScroll), a18 22 ret2426LoadFirstScreen:2730 push af31 dec a32 call InitVariablesForScroll33 pop af36 push af37 38 ld (Seg_P8000_SW), a39 40 ld hl, START_ADDR_MEGAROM_PAGE 41 ld de, NAMTBL + (0 * (256 * 64)) 42 ld bc, PAGE_SIZE 43 call BIOS_LDIRVM 44 pop af45 46 inc a47 push af48 50 ld (Seg_P8000_SW), a51 52 ld hl, START_ADDR_MEGAROM_PAGE 53 ld de, NAMTBL + (1 * (256 * 64)) 54 ld bc, PAGE_SIZE 55 call BIOS_LDIRVM 56 pop af58 inc a59 push af60 62 ld (Seg_P8000_SW), a63 64 ld hl, START_ADDR_MEGAROM_PAGE 65 ld de, NAMTBL + (2 * (256 * 64)) 66 ld bc, PAGE_SIZE 67 call BIOS_LDIRVM 68 pop af70 ret73SCROLL_FULL_SPEED: equ 0000 0000 b74SCROLL_HALF_SPEED: equ 0000 0001 b 76ExecuteScroll:78 79 ld a, (BIOS_JIFFY) 80 and SCROLL_FULL_SPEED81 ret nz84 86 88 ld a, (CurrentMegaROMPage)89 ld (Seg_P8000_SW), a90 ld hl, (CurrentAddrLineScroll) 91 ld de, (CurrentVRAMAddrLineScroll) 92 ld bc, 256 93 call BIOS_LDIRVM 99 100 ld de, (CurrentVRAMAddrLineScroll)101 dec d 102 ld hl, (CurrentAddrLineScroll)103 dec h 104 ld a, h105 cp 0x80 - 1 106 jp z, .decPage107 jp .dontDecPage108.decPage:109 ld a, (CurrentMegaROMPage)110 dec a111 jp z, .stopScroll112 ld (CurrentMegaROMPage), a113 ld hl, ADDR_LAST_LINE_OF_PAGE114.dontDecPage:115 ld (CurrentAddrLineScroll), hl116 ld (CurrentVRAMAddrLineScroll), de119 121 127 128 ld hl, VerticalScroll129 dec (hl)130 ld b, (hl) 132 ld c, 23 133 call BIOS_WRTVDP136 ld hl, Screen_Y_Origin137 dec (hl)139 140 call AdjustSprites_Y143 ret145.stopScroll:146147 jp Execute150AdjustSprites_Y:151 153 ld hl, Player_Y154 call .adjustSprite157 ld hl, PlayerShot_0_Struct + 2158 call .adjustSprite159 ld hl, PlayerShot_1_Struct + 2160 call .adjustSprite161 ld hl, PlayerShot_2_Struct + 2162 call .adjustSprite163 165 ld hl, Enemy_0_Struct + 2166 call .adjustSprite167 ld hl, Enemy_1_Struct + 2168 call .adjustSprite169 ld hl, Enemy_2_Struct + 2170 call .adjustSprite171 ld hl, Enemy_3_Struct + 2172 call .adjustSprite173 ld hl, Enemy_4_Struct + 2174 call .adjustSprite175 ld hl, Enemy_5_Struct + 2176 call .adjustSprite177 ld hl, Enemy_6_Struct + 2178 call .adjustSprite180 ret182.adjustSprite:184 186 ld a, (hl)187 dec a188 cp 216 189 jp nz, .continue190 ld a, 215191.continue:192 ld (hl), a193 retMain.s26 ReadInput.s1PLANE_PLAYER_WIDTH: equ 212PLANE_PLAYER_HEIGHT: equ 313PLANE_PLAYER_PIXELS_PER_MOV: equ 35ReadInput:6 7 ld a, 8 8 call BIOS_SNSMAT 9 ld e, a 12 push de13 bit 0, a 14 call z, .shot15 pop de17 ld a, e18 bit 4, a 19 call z, .playerLeft21 ld a, e22 bit 7, a 23 call z, .playerRight24 25 ld a, e26 bit 5, a 27 call z, .playerUp29 ld a, e30 bit 6, a 31 call z, .playerDown33 ret35.playerLeft:36 ld a, (Player_X)37 sub PLANE_PLAYER_PIXELS_PER_MOV38 ret c39 ld (Player_X), a41 46 ret48.playerRight:49 ld a, (Player_X)50 add PLANE_PLAYER_PIXELS_PER_MOV51 cp 255 - PLANE_PLAYER_WIDTH52 ret nc53 ld (Player_X), a55 60 ret62.playerUp:63 ld a, (Player_Y_Static)64 sub PLANE_PLAYER_PIXELS_PER_MOV65 ret c66 ld (Player_Y_Static), a68 ld a, (Player_Y)69 sub PLANE_PLAYER_PIXELS_PER_MOV70 ld (Player_Y), a72 ret74.playerDown:75 ld a, (Player_Y_Static)76 add PLANE_PLAYER_PIXELS_PER_MOV77 cp 191 - PLANE_PLAYER_HEIGHT78 ret nc79 ld (Player_Y_Static), a81 ld a, (Player_Y)82 add PLANE_PLAYER_PIXELS_PER_MOV83 ld (Player_Y), a85 ret87.shot:88 89 ld hl, (NextShot_Struct_Addr)90 call PlayerShot_Init92 ret94Main.s27 GameLogic/GameLogic.s13GameLogic:5 ld hl, PlayerShot_0_Struct6 call PlayerShot_Logic7 ld hl, PlayerShot_1_Struct8 call PlayerShot_Logic9 ld hl, PlayerShot_2_Struct10 call PlayerShot_Logic11 19 21 ld hl, Enemy_0_Struct22 call Enemy_Logic23 ld hl, Enemy_1_Struct24 call Enemy_Logic25 ld hl, Enemy_2_Struct26 call Enemy_Logic27 ld hl, Enemy_3_Struct28 call Enemy_Logic29 ld hl, Enemy_4_Struct30 call Enemy_Logic31 ld hl, Enemy_5_Struct32 call Enemy_Logic33 ld hl, Enemy_6_Struct34 call Enemy_Logic36 38 ld hl, (LevelCounter)39 inc hl40 ld (LevelCounter), hl43 44 ld hl, (LevelData_CurrentAddr)45 ld de, (LevelCounter)46.loop:47 push hl 48 push de49 50 ld a, (hl)51 inc hl52 ld h, (hl)53 ld l, a55 56 or h57 jp z, .endOfLevelData59 60 call BIOS_DCOMPR 61 pop de62 pop hl64 ld (LevelData_CurrentAddr), hl65 jp z, .executeLevelData66 jp nc, .exitLevelData 68 69 ld bc, LevelData_Temp_Struct.size70 add hl, bc71 jp .loop73.endOfLevelData:74 pop de 75 pop hl76 jp .exitLevelData78.executeLevelData:79 82 84 85 ld de, (LevelData_CurrentAddr)86 call Enemy_Init88.exitLevelData:94 96 97 ld a, (Player_FramesSinceLastShot)98 inc a99 ret z100 101 ld (Player_FramesSinceLastShot), a104 ret105Main.s28 GameLogic/PlayerShotLogic.s12FRAMES_BETWEEN_PLAYER_SHOTS: equ 446PlayerShot_Init:8 9 ld a, (Player_FramesSinceLastShot)10 cp FRAMES_BETWEEN_PLAYER_SHOTS11 ret c13 xor a14 ld (Player_FramesSinceLastShot), a18 ld a, (hl) 19 or a20 ret nz 23 ld a, (Player_Y_Static)24 cp 1625 ret c 28 inc a29 ld (hl), a 31 inc hl32 ld a, (Player_X)33 ld (hl), a 35 inc hl36 ld a, (Player_Y)37 sub 1638 ld (hl), a 40 inc hl41 ld a, (Player_Y_Static)42 sub 1643 ld (hl), a 45 46 ld hl, (NextShot_Struct_Addr)48 ld bc, PlayerShot_Temp_Struct.size49 add hl, bc51 ld de, PlayerShot_2_Struct + PlayerShot_Temp_Struct.size52 call BIOS_DCOMPR 53 jp nz, .dontResetNextShot55 ld hl, PlayerShot_0_Struct 57.dontResetNextShot:58 ld (NextShot_Struct_Addr), hl61 ret6365PlayerShot_Reset:66 xor a67 ld (hl), a 69 inc hl70 ld a, 25571 ld (hl), a 73 inc hl74 77 inc hl78 ld a, 19279 ld (hl), a 81 ret8385PlayerShot_Logic:86 ld a, (hl) 87 or a88 ret z 90 inc hl91 inc hl92 inc hl93 ld a, (hl) 94 cp 895 jp c, .shotReset 96 sub 897 ld (hl), a100 dec hl101 ld a, (hl) 102 sub 8103 ld (hl), a105 ret107.shotReset:108 dec hl 109 dec hl110 dec hl111 call PlayerShot_Reset112 ret113Main.s29 GameLogic/EnemyLogic.s1ENEMY_PIXELS_PER_MOV: equ 347Enemy_Init:9 11 12 push de13 inc de14 inc de15 inc de16 inc de17 inc de18 inc de19 ld a, (de)20 or a21 jp z, .enemy_022 dec a23 jp z, .enemy_124 dec a25 jp z, .enemy_226 dec a27 jp z, .enemy_328 dec a29 jp z, .enemy_430 dec a31 jp z, .enemy_532 dec a33 jp z, .enemy_634.enemy_0:35 ld hl, Enemy_0_Struct36 ld bc, ENEMY_0_SPRCOL_ADDR37 jp .endEnemyNumber38.enemy_1:39 ld hl, Enemy_1_Struct40 ld bc, ENEMY_1_SPRCOL_ADDR41 jp .endEnemyNumber42.enemy_2:43 ld hl, Enemy_2_Struct44 ld bc, ENEMY_2_SPRCOL_ADDR45 jp .endEnemyNumber46.enemy_3:47 ld hl, Enemy_3_Struct48 ld bc, ENEMY_3_SPRCOL_ADDR49 jp .endEnemyNumber50.enemy_4:51 ld hl, Enemy_4_Struct52 ld bc, ENEMY_4_SPRCOL_ADDR53 jp .endEnemyNumber54.enemy_5:55 ld hl, Enemy_5_Struct56 ld bc, ENEMY_5_SPRCOL_ADDR57 jp .endEnemyNumber58.enemy_6:59 ld hl, Enemy_6_Struct60 ld bc, ENEMY_6_SPRCOL_ADDR61 jp .endEnemyNumber62.endEnemyNumber:63 pop de66 67 push bc68 push hl69 ld a, 0000 0001 b70 ld h, b71 ld l, c72 call SetVdp_Write73 74 ld c, PORT_0 75 ld hl, SpriteColors_EnemyPlane_0_and_176 78 outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi 79 outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi outi 80 pop hl82 ld a, 183 ld (hl), a 85 inc hl86 88 inc de89 inc de90 inc de91 ld a, (de)92 ld (hl), a 94 inc hl95 ld a, (Screen_Y_Origin)96 ld (hl), a 98 inc hl99 xor a100 ld (hl), a 102 inc hl103 ld a, ENEMY_SPR_PAT_0_NUMBER104 ld (hl), a 106 inc hl107 ld a, ENEMY_SPR_PAT_1_NUMBER108 ld (hl), a 110 inc hl111 112 inc de113 ld a, (de)114 ld (hl), a 116 inc hl117 inc de118 ld a, (de)119 ld (hl), a 120 pop bc122 inc hl123 ld (hl), c 125 inc hl126 ld (hl), b 128 ret132134Enemy_Reset:135 xor a136 ld (hl), a 138 inc hl139 ld a, 255140 ld (hl), a 142 inc hl143 145 inc hl146 ld a, 192147 ld (hl), a 149 inc hl150 ld a, EMPTY_SPR_PAT_NUMBER151 ld (hl), a 153 inc hl154 ld a, EMPTY_SPR_PAT_NUMBER155 ld (hl), a 157 ret161163Enemy_Logic:165 push hl167 169 ld de, Enemy_Temp_Struct 170 ld bc, Enemy_Temp_Struct.size 171 ldir 174 175 ld a, (Enemy_Temp_Status) 176 or a177 jp z, .return 179 cp 1180 jp nz, .doExplosionAnimation 183 185 ld a, (Enemy_Temp_Y_Static) 186 cp 192187 jp nc, .enemyReset 188 add ENEMY_PIXELS_PER_MOV189 ld (Enemy_Temp_Y_Static), a192 ld a, (Enemy_Temp_Y) 193 add ENEMY_PIXELS_PER_MOV194 ld (Enemy_Temp_Y), a197 198 ld hl, (Enemy_Temp_Delta_X_Current_Addr) 199 ld a, l200 or h 201 jp z, .ignoreDeltaX202 203 ld b, (hl) 204 ld a, (Enemy_Temp_X) 205 add a, b 207 ld (Enemy_Temp_X), a 209 inc hl 210 inc hl211 ld (Enemy_Temp_Delta_X_Current_Addr), hl212 .ignoreDeltaX:214 216 217 ld a, (Enemy_Temp_X)218 ld b, a219 ld a, (Enemy_Temp_Y_Static)220 ld c, a222 push bc223 ld hl, PlayerShot_0_Struct224 call CheckCol_Enemy_PlayerShot225 pop bc226 push bc227 ld hl, PlayerShot_1_Struct228 call CheckCol_Enemy_PlayerShot229 pop bc230 push bc231 ld hl, PlayerShot_2_Struct232 call CheckCol_Enemy_PlayerShot233 pop bc235 jp .return237 .enemyReset:238 ld hl, Enemy_Temp_Struct239 call Enemy_Reset240 jp .return241 243.return:244 ld hl, Enemy_Temp_Struct 245 pop de 246 ld bc, Enemy_Temp_Struct.size 247 ldir 249 ret252.doExplosionAnimation:254 ld a, (Enemy_Temp_Status) 255 inc a256 ld (Enemy_Temp_Status), a257 cp 16258 ld hl, Enemy_Temp_Struct259 call z, Enemy_Reset262 ld a, (Enemy_Temp_Status) 263 cp 3264 jp z, .loadExplosionFrame_0 265 cp 8266 jp z, .loadExplosionFrame_1 267 cp 12268 jp z, .loadExplosionFrame_2 269 jp .return271.loadExplosionFrame_0:272 ld a, EXPLOSION_SPR_PAT_0_NUMBER273 ld (Enemy_Temp_Pattern_0), a274 ld a, EMPTY_SPR_PAT_NUMBER275 ld (Enemy_Temp_Pattern_1), a276 277 278 ld a, (Enemy_Temp_SPRCOL_Addr) 279 ld l, a280 ld a, (Enemy_Temp_SPRCOL_Addr + 1) 281 ld h, a282 ld a, 0000 0001 b283 call SetVdp_Write284 ld c, PORT_0285 ld hl, SpriteColors_Explosion_Frames_0_to_2286 287 outi outi outi outi288 outi outi outi outi289 outi outi outi outi290 outi outi outi outi 292 306 jp .return308.loadExplosionFrame_1:309 ld a, EXPLOSION_SPR_PAT_1_NUMBER310 ld (Enemy_Temp_Pattern_0), a311 ld a, EMPTY_SPR_PAT_NUMBER312 ld (Enemy_Temp_Pattern_1), a314 315 ld a, (Enemy_Temp_SPRCOL_Addr) 316 ld l, a317 ld a, (Enemy_Temp_SPRCOL_Addr + 1) 318 ld h, a319 ld a, 0000 0001 b320 call SetVdp_Write321 ld c, PORT_0322 ld hl, SpriteColors_Explosion_Frames_0_to_2 + 16323 324 outi outi outi outi325 outi outi outi outi326 outi outi outi outi327 outi outi outi outi 329 jp .return331.loadExplosionFrame_2:332 ld a, EXPLOSION_SPR_PAT_2_NUMBER333 ld (Enemy_Temp_Pattern_0), a334 ld a, EMPTY_SPR_PAT_NUMBER335 ld (Enemy_Temp_Pattern_1), a337 338 ld a, (Enemy_Temp_SPRCOL_Addr) 339 ld l, a340 ld a, (Enemy_Temp_SPRCOL_Addr + 1) 341 ld h, a342 ld a, 0000 0001 b343 call SetVdp_Write344 ld c, PORT_0345 ld hl, SpriteColors_Explosion_Frames_0_to_2 + 32346 347 outi outi outi outi348 outi outi outi outi349 outi outi outi outi350 outi outi outi outi 352 jp .return356359CheckCol_Enemy_PlayerShot:360 ld a, (hl) 361 or a362 ret z 364 push hl365 inc hl366 ld a, (hl) 367 ld d, a369 inc hl370 inc hl371 ld a, (hl) 372 ld e, a373 call CheckCollision_16x16_16x16374 pop hl375 jp c, .collision376 ret377 379 .collision:380 call PlayerShot_Reset381 ld hl, Enemy_Temp_Struct383 385 call StartExplosionAnimation387 ret389StartExplosionAnimation:390 ld a, 2391 ld (hl), a393 400 404 retMain.s30 LevelData/Level_1.s1ENEMY_TYPE_1: equ 12ENEMY_SHOT: equ 25Level_1_Data:6 dw 20 db ENEMY_TYPE_1, 32 dw EnemyDeltaX_1 db 07 dw 21 db ENEMY_TYPE_1, 64 dw EnemyDeltaX_1 db 1 8 dw 22 db ENEMY_TYPE_1, 96 dw EnemyDeltaX_1 db 29 dw 23 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_1 db 310 dw 30 db ENEMY_TYPE_1, 64 dw EnemyDeltaX_1 db 411 dw 31 db ENEMY_TYPE_1, 96 dw EnemyDeltaX_1 db 512 dw 32 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_1 db 614 dw 150 db ENEMY_TYPE_1, 64 dw EnemyDeltaX_2 db 015 dw 151 db ENEMY_TYPE_1, 96 dw EnemyDeltaX_2 db 116 dw 152 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 217 dw 153 db ENEMY_TYPE_1, 160 dw EnemyDeltaX_2 db 318 dw 160 db ENEMY_TYPE_1, 64+16 dw EnemyDeltaX_2 db 419 dw 161 db ENEMY_TYPE_1, 96+16 dw EnemyDeltaX_2 db 520 dw 162 db ENEMY_TYPE_1, 128+16 dw EnemyDeltaX_2 db 622 dw 250 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 023 dw 251 db ENEMY_TYPE_1, 112 dw EnemyDeltaX_0 db 124 dw 252 db ENEMY_TYPE_1, 144 dw EnemyDeltaX_1 db 225 dw 253 db ENEMY_TYPE_1, 176 dw EnemyDeltaX_1 db 327 dw 350 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 028 dw 360 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 129 dw 370 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 230 dw 380 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 331 dw 390 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 432 dw 400 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 533 dw 410 db ENEMY_TYPE_1, 80 dw EnemyDeltaX_0 db 635 dw 500 db ENEMY_TYPE_1, 128 dw 0 db 036 dw 510 db ENEMY_TYPE_1, 128 dw 0 db 137 dw 520 db ENEMY_TYPE_1, 128 dw 0 db 238 dw 530 db ENEMY_TYPE_1, 128 dw 0 db 339 dw 540 db ENEMY_TYPE_1, 128 dw 0 db 440 dw 550 db ENEMY_TYPE_1, 128 dw 0 db 541 dw 560 db ENEMY_TYPE_1, 128 dw 0 db 643 dw 650 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 044 dw 660 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 145 dw 670 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 246 dw 680 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 347 dw 690 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 448 dw 700 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 549 dw 710 db ENEMY_TYPE_1, 128 dw EnemyDeltaX_2 db 651 52 dw 053Main.s31 EnemyData/EnemyData_1.s13EnemyDeltaX_0: db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 4 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 5 db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -16 db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -17 db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -18 db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -19 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 10 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 12EnemyDeltaX_1: db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 13 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 14 db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 115 db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 116 db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 117 db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 118 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 19 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 21EnemyDeltaX_2: db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 122 db 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 223 db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 124 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 25 db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -126 db -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -227 db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -128 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 29Main.s32 EnemyData/EnemyShotData.s1EnemyShotDeltaX_0: db -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -12EnemyShotDeltaY_0: db 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 13Main.s34 35 Graphics/Sprites/SpriteAssets.s1PaletteData:2 INCBIN "Graphics/Sprites/player_plane_0.pal"4 2325SpritePattern_PlayerPlane_0_and_1:26 INCBIN "Graphics/Sprites/player_plane_0.pat"27.size: equ $ - SpritePattern_PlayerPlane_0_and_128SpritePattern_PlayerPlane_2_and_3:29 INCBIN "Graphics/Sprites/player_plane_1.pat"30.size: equ $ - SpritePattern_PlayerPlane_2_and_332SpritePattern_PlayerShot:33 Graphics/Sprites/player_shot_pattern.s1 db 01000100b2 db 11001100b3 db 11001110b4 db 11001110b5 db 11101110b6 db 11101110b7 db 11101110b8 db 11101110b9 db 11101100b10 db 11101100b11 db 01100100b12 db 01100100b13 db 01000100b14 db 01000100b15 db 01000000b16 db 01000100b17 db 01001100b18 db 11001010b19 db 11001110b20 db 11101110b21 db 11101110b22 db 11101110b23 db 11101110b24 db 11101100b25 db 11101100b26 db 01100100b27 db 01000100b28 db 01000100b29 db 01000100b30 db 01000100b31 db 01000100b32 db 00000000bGraphics/Sprites/SpriteAssets.s34.size: equ $ - SpritePattern_PlayerShot36SpritePattern_EnemyPlane_0_and_1:37 INCBIN "Graphics/Sprites/enemy_plane.pat"38.size: equ $ - SpritePattern_EnemyPlane_0_and_140SpritePattern_Explosion_Frames_0_to_2:41 Graphics/Sprites/explosion_frames_patterns.s12 DB 00000000b3 DB 00000000b4 DB 00000000b5 DB 00000000b6 DB 00000011b7 DB 00000111b8 DB 00001111b9 DB 00001111b10 DB 00001111b11 DB 00001111b12 DB 00000111b13 DB 00000011b14 DB 00000000b15 DB 00000000b16 DB 00000000b17 DB 00000000b18 DB 00000000b19 DB 00000000b20 DB 00000000b21 DB 00000000b22 DB 11000000b23 DB 11100000b24 DB 11110000b25 DB 11110000b26 DB 11110000b27 DB 11110000b28 DB 11100000b29 DB 11000000b30 DB 00000000b31 DB 00000000b32 DB 00000000b33 DB 00000000b3536 DB 00000011b37 DB 00001111b38 DB 00111111b39 DB 00111111b40 DB 01111111b41 DB 11111111b42 DB 11111111b43 DB 11111111b44 DB 11111111b45 DB 01111111b46 DB 01111111b47 DB 01111111b48 DB 00111111b49 DB 00001111b50 DB 00000111b51 DB 00000011b52 DB 11000000b53 DB 11110000b54 DB 11111100b55 DB 11111110b56 DB 11111110b57 DB 11111111b58 DB 11111111b59 DB 11111111b60 DB 11111111b61 DB 11111111b62 DB 11111110b63 DB 11111110b64 DB 11111110b65 DB 11111100b66 DB 11111000b67 DB 11000000b6970 DB 00000011b71 DB 00010001b72 DB 00101110b73 DB 01011111b74 DB 00011111b75 DB 10111110b76 DB 00000100b77 DB 00100000b78 DB 01100100b79 DB 01110010b80 DB 00110000b81 DB 00100000b82 DB 01000000b83 DB 00110000b84 DB 00001000b85 DB 00000101b86 DB 00000000b87 DB 10100000b88 DB 00000100b89 DB 00000010b90 DB 00000100b91 DB 00000011b92 DB 00001111b93 DB 00111111b94 DB 01111111b95 DB 10111110b96 DB 01011110b97 DB 00111100b98 DB 00011100b99 DB 00001000b100 DB 01000000b101 DB 10100000b102Graphics/Sprites/SpriteAssets.s42.size: equ $ - SpritePattern_Explosion_Frames_0_to_244SpritePattern_EnemyShot_0_and_1:45 Graphics/Sprites/enemy_shot_patterns.s1 4 DB 00111000b5 DB 01111100b6 DB 11111100b7 DB 11111100b8 DB 11111000b9 DB 01110000b10 DB 00000000b11 DB 00000000b12 DB 00000000b13 DB 00000000b14 DB 00000000b15 DB 00000000b16 DB 00000000b17 DB 00000000b18 DB 00000000b19 DB 00000000b20 DB 00000000b21 DB 00000000b22 DB 00000000b23 DB 00000000b24 DB 00000000b25 DB 00000000b26 DB 00000000b27 DB 00000000b28 DB 00000000b29 DB 00000000b30 DB 00000000b31 DB 00000000b32 DB 00000000b33 DB 00000000b34 DB 00000000b35 DB 00000000b36 39 DB 01110000b40 DB 11111000b41 DB 11111100b42 DB 11111100b43 DB 01111100b44 DB 00111000b45 DB 00000000b46 DB 00000000b47 DB 00000000b48 DB 00000000b49 DB 00000000b50 DB 00000000b51 DB 00000000b52 DB 00000000b53 DB 00000000b54 DB 00000000b55 DB 00000000b56 DB 00000000b57 DB 00000000b58 DB 00000000b59 DB 00000000b60 DB 00000000b61 DB 00000000b62 DB 00000000b63 DB 00000000b64 DB 00000000b65 DB 00000000b66 DB 00000000b67 DB 00000000b68 DB 00000000b69 DB 00000000b70 DB 00000000b71Graphics/Sprites/SpriteAssets.s46.size: equ $ - SpritePattern_EnemyShot_0_and_14850SpriteColors_PlayerPlane_0_and_1:51 INCBIN "Graphics/Sprites/player_plane_0.col"52.size: equ $ - SpriteColors_PlayerPlane_0_and_153SpriteColors_PlayerPlane_2_and_3:54 INCBIN "Graphics/Sprites/player_plane_1.col"55.size: equ $ - SpriteColors_PlayerPlane_2_and_357SpriteColors_PlayerShot:58 Graphics/Sprites/player_shot_color.s1 db 132 db 133 db 134 db 135 db 136 db 97 db 98 db 99 db 510 db 511 db 512 db 513 db 514 db 515 db 516 db 5Graphics/Sprites/SpriteAssets.s59.size: equ $ - SpriteColors_PlayerShot61SpriteColors_EnemyPlane_0_and_1:62 INCBIN "Graphics/Sprites/enemy_plane.col"63.size: equ $ - SpriteColors_EnemyPlane_0_and_165SpriteColors_Explosion_Frames_0_to_2:66 Graphics/Sprites/explosion_frames_colors.s1 2 db 8, 8, 8, 8, 8, 8, 8, 83 db 8, 8, 8, 8, 8, 8, 8, 84 6 db 12, 12, 12, 12, 12, 12, 12, 127 db 12, 12, 12, 12, 12, 12, 12, 128 10 DB 4, 4, 4, 4, 4, 4, 4, 411 DB 4, 4, 4, 4, 4, 4, 4, 412Graphics/Sprites/SpriteAssets.s67.size: equ $ - SpriteColors_Explosion_Frames_0_to_269SpriteColors_EnemyShot_0_to_2:70 Graphics/Sprites/enemy_shot_colors.s1 2 db 8, 8, 8, 8, 8, 8, 8, 83 db 0, 0, 0, 0, 0, 0, 0, 04 5 db 12, 12, 12, 12, 12, 12, 12, 126 db 0, 0, 0, 0, 0, 0, 0, 07 8 db 13, 13, 13, 13, 13, 13, 13, 139 db 0, 0, 0, 0, 0, 0, 0, 010 Graphics/Sprites/SpriteAssets.s71.size: equ $ - SpriteColors_EnemyShot_0_to_272Main.s36 39LEVEL_1_FIRST_SCREEN_PAGE: equ 1440LEVEL_2_FIRST_SCREEN_PAGE: equ 3043Execute:44 call EnableRomPage246 47 ld a, 148 ld (Seg_P8000_SW), a50 call InitVram5455 call ClearRam58 call InitVariables61 ld a, LEVEL_1_FIRST_SCREEN_PAGE62 63 call LoadFirstScreen66 call BIOS_ENASCR6871 76.gameLoop:77 ld hl, BIOS_JIFFY 78 ld a, (hl)79.waitVBlank:80 cp (hl)81 jr z, .waitVBlank85 IFDEF DEBUG86 ld a, 4 87 ld (BIOS_BDRCLR), a 88 call BIOS_CHGCLR 89 ENDIF91 call ExecuteScroll93 call BlitSPRATR96 IFDEF DEBUG97 ld a, 7 98 ld (BIOS_BDRCLR), a 99 call BIOS_CHGCLR 100 ENDIF103 call ReadInput105 call GameLogic107 109 call UpdateSpriteAttrTableBuffer113 IFDEF DEBUG114 ld a, 8 115 ld (BIOS_BDRCLR), a 116 call BIOS_CHGCLR 117 ENDIF122 jp .gameLoop128End:134InitialSpriteAttributes:135 137139 140 db PLAYER_INITIAL_Y, PLAYER_INITIAL_X, PLAYER_SPR_PAT_0_NUMBER, 0141 db PLAYER_INITIAL_Y, PLAYER_INITIAL_X, PLAYER_SPR_PAT_1_NUMBER, 0143 144 db PLAYER_INITIAL_Y + 16, PLAYER_INITIAL_X, PLAYER_SPR_PAT_2_NUMBER, 0145 db PLAYER_INITIAL_Y + 16, PLAYER_INITIAL_X, PLAYER_SPR_PAT_3_NUMBER, 0147149 150 db 192, 255, EMPTY_SPR_PAT_NUMBER, 0151 db 192, 255, EMPTY_SPR_PAT_NUMBER, 0152 db 192, 255, EMPTY_SPR_PAT_NUMBER, 0154156 158 db 0, 0, ENEMY_SPR_PAT_0_NUMBER, 0159 db 0, 0, ENEMY_SPR_PAT_1_NUMBER, 0160 161 db 192, 255, ENEMY_SPR_PAT_0_NUMBER, 0162 db 192, 255, ENEMY_SPR_PAT_1_NUMBER, 0163 164 db 192, 255, ENEMY_SPR_PAT_0_NUMBER, 0165 db 192, 255, ENEMY_SPR_PAT_1_NUMBER, 0166 167 db 30, 0, ENEMY_SPR_PAT_0_NUMBER, 0168 db 30, 0, ENEMY_SPR_PAT_1_NUMBER, 0169 170 db 60, 0, ENEMY_SPR_PAT_0_NUMBER, 0171 db 60, 0, ENEMY_SPR_PAT_1_NUMBER, 0172 173 db 90, 0, ENEMY_SPR_PAT_0_NUMBER, 0174 db 90, 0, ENEMY_SPR_PAT_1_NUMBER, 0176177 db 216, 0, 0, 0179.size: equ $ - InitialSpriteAttributes188 db "End ROM started at 0x4000"190 ds PAGE_SIZE - ($ - 0x4000), 255 195202203 MegaRomPages.s1356 org 0x8000, 0xBFFF7 INCBIN "Graphics/Bitmaps/Level_1/level1_0.sra.new"8 ds PAGE_SIZE - ($ - 0x8000), 2551011 org 0x8000, 0xBFFF12 INCBIN "Graphics/Bitmaps/Level_1/level1_1.sra.new"13 ds PAGE_SIZE - ($ - 0x8000), 2551516 org 0x8000, 0xBFFF17 INCBIN "Graphics/Bitmaps/Level_1/level1_2.sra.new"18 ds PAGE_SIZE - ($ - 0x8000), 2552021 org 0x8000, 0xBFFF22 INCBIN "Graphics/Bitmaps/Level_1/level1_3.sra.new"23 ds PAGE_SIZE - ($ - 0x8000), 2552526 org 0x8000, 0xBFFF27 INCBIN "Graphics/Bitmaps/Level_1/level1_4.sra.new"28 ds PAGE_SIZE - ($ - 0x8000), 2553031 org 0x8000, 0xBFFF32 INCBIN "Graphics/Bitmaps/Level_1/level1_5.sra.new"33 ds PAGE_SIZE - ($ - 0x8000), 2553536 org 0x8000, 0xBFFF37 INCBIN "Graphics/Bitmaps/Level_1/level1_6.sra.new"38 ds PAGE_SIZE - ($ - 0x8000), 2554041 org 0x8000, 0xBFFF42 INCBIN "Graphics/Bitmaps/Level_1/level1_7.sra.new"43 ds PAGE_SIZE - ($ - 0x8000), 2554546 org 0x8000, 0xBFFF47 INCBIN "Graphics/Bitmaps/Level_1/level1_8.sra.new"48 ds PAGE_SIZE - ($ - 0x8000), 2555051 org 0x8000, 0xBFFF52 INCBIN "Graphics/Bitmaps/Level_1/level1_9.sra.new"53 ds PAGE_SIZE - ($ - 0x8000), 2555556 org 0x8000, 0xBFFF57 INCBIN "Graphics/Bitmaps/Level_1/level1_10.sra.new"58 ds PAGE_SIZE - ($ - 0x8000), 2556061 org 0x8000, 0xBFFF62 INCBIN "Graphics/Bitmaps/Level_1/level1_11.sra.new"63 ds PAGE_SIZE - ($ - 0x8000), 2556566 org 0x8000, 0xBFFF67 INCBIN "Graphics/Bitmaps/Level_1/level1_12.sra.new"68 ds PAGE_SIZE - ($ - 0x8000), 2557071 org 0x8000, 0xBFFF72 INCBIN "Graphics/Bitmaps/Level_1/level1_13.sra.new"73 ds PAGE_SIZE - ($ - 0x8000), 2557576 org 0x8000, 0xBFFF77 INCBIN "Graphics/Bitmaps/Level_1/level1_14.sra.new"78 ds PAGE_SIZE - ($ - 0x8000), 2558081 org 0x8000, 0xBFFF82 INCBIN "Graphics/Bitmaps/Level_1/level1_15.sra.new"83 ds PAGE_SIZE - ($ - 0x8000), 255858788 org 0x8000, 0xBFFF89 INCBIN "Graphics/Bitmaps/Level_2/level2_0.sra.new"90 ds PAGE_SIZE - ($ - 0x8000), 2559293 org 0x8000, 0xBFFF94 INCBIN "Graphics/Bitmaps/Level_2/level2_1.sra.new"95 ds PAGE_SIZE - ($ - 0x8000), 2559799 org 0x8000, 0xBFFF100 INCBIN "Graphics/Bitmaps/Level_2/level2_2.sra.new"101 ds PAGE_SIZE - ($ - 0x8000), 255103104 org 0x8000, 0xBFFF105 INCBIN "Graphics/Bitmaps/Level_2/level2_3.sra.new"106 ds PAGE_SIZE - ($ - 0x8000), 255108109 org 0x8000, 0xBFFF110 INCBIN "Graphics/Bitmaps/Level_2/level2_4.sra.new"111 ds PAGE_SIZE - ($ - 0x8000), 255113114 org 0x8000, 0xBFFF115 INCBIN "Graphics/Bitmaps/Level_2/level2_5.sra.new"116 ds PAGE_SIZE - ($ - 0x8000), 255118119 org 0x8000, 0xBFFF120 INCBIN "Graphics/Bitmaps/Level_2/level2_6.sra.new"121 ds PAGE_SIZE - ($ - 0x8000), 255123124 org 0x8000, 0xBFFF125 INCBIN "Graphics/Bitmaps/Level_2/level2_7.sra.new"126 ds PAGE_SIZE - ($ - 0x8000), 255128129 org 0x8000, 0xBFFF130 INCBIN "Graphics/Bitmaps/Level_2/level2_8.sra.new"131 ds PAGE_SIZE - ($ - 0x8000), 255133134 org 0x8000, 0xBFFF135 INCBIN "Graphics/Bitmaps/Level_2/level2_9.sra.new"136 ds PAGE_SIZE - ($ - 0x8000), 255138139 org 0x8000, 0xBFFF140 INCBIN "Graphics/Bitmaps/Level_2/level2_10.sra.new"141 ds PAGE_SIZE - ($ - 0x8000), 255143144 org 0x8000, 0xBFFF145 INCBIN "Graphics/Bitmaps/Level_2/level2_11.sra.new"146 ds PAGE_SIZE - ($ - 0x8000), 255148149 org 0x8000, 0xBFFF150 INCBIN "Graphics/Bitmaps/Level_2/level2_12.sra.new"151 ds PAGE_SIZE - ($ - 0x8000), 255153154 org 0x8000, 0xBFFF155 INCBIN "Graphics/Bitmaps/Level_2/level2_13.sra.new"156 ds PAGE_SIZE - ($ - 0x8000), 255158159 org 0x8000, 0xBFFF160 INCBIN "Graphics/Bitmaps/Level_2/level2_14.sra.new"161 ds PAGE_SIZE - ($ - 0x8000), 255163164 org 0x8000, 0xBFFF165 INCBIN "Graphics/Bitmaps/Level_2/level2_15.sra.new"166 ds PAGE_SIZE - ($ - 0x8000), 255167Main.s208209 org 0xc000, 0xe5ff 211RamStart:212 Variables.s1Player_X: rb 12Player_Y: rb 13Player_Y_Static: rb 1 57PlayerShot_Temp_Struct:8PlayerShot_Temp_Status: rb 1 9PlayerShot_Temp_X: rb 110PlayerShot_Temp_Y: rb 111PlayerShot_Temp_Y_Static: rb 1 12PlayerShot_Temp_Struct.size: equ $ - PlayerShot_Temp_Struct16PlayerShot_0_Struct: rb PlayerShot_Temp_Struct.size17PlayerShot_1_Struct: rb PlayerShot_Temp_Struct.size18PlayerShot_2_Struct: rb PlayerShot_Temp_Struct.size1924NextShot_Struct_Addr: rw 125Player_FramesSinceLastShot: rb 12729Enemy_Temp_Struct:30Enemy_Temp_Status: rb 1 31Enemy_Temp_X: rb 132Enemy_Temp_Y: rb 133Enemy_Temp_Y_Static: rb 1 34Enemy_Temp_Pattern_0: rb 135Enemy_Temp_Pattern_1: rb 136Enemy_Temp_Delta_X_Current_Addr: rw 137Enemy_Temp_SPRCOL_Addr: rw 138Enemy_Temp_Struct.size: equ $ - Enemy_Temp_Struct42Enemy_0_Struct: rb Enemy_Temp_Struct.size43Enemy_1_Struct: rb Enemy_Temp_Struct.size44Enemy_2_Struct: rb Enemy_Temp_Struct.size45Enemy_3_Struct: rb Enemy_Temp_Struct.size46Enemy_4_Struct: rb Enemy_Temp_Struct.size47Enemy_5_Struct: rb Enemy_Temp_Struct.size48Enemy_6_Struct: rb Enemy_Temp_Struct.size5153EnemyShot_Temp_Struct:54EnemyShot_Temp_Status: rb 1 55EnemyShot_Temp_X: rb 156EnemyShot_Temp_Y: rb 157EnemyShot_Temp_Y_Static: rb 1 58EnemyShot_Temp_Delta_X_Current_Addr: rw 159EnemyShot_Temp_Delta_Y_Current_Addr: rw 160EnemyShot_Temp_SPRCOL_Addr: rw 161EnemyShot_Temp_Struct.size: equ $ - EnemyShot_Temp_Struct65EnemyShot_0_Struct: rb Enemy_Temp_Struct.size66EnemyShot_1_Struct: rb Enemy_Temp_Struct.size67EnemyShot_2_Struct: rb Enemy_Temp_Struct.size68EnemyShot_3_Struct: rb Enemy_Temp_Struct.size69EnemyShot_4_Struct: rb Enemy_Temp_Struct.size70EnemyShot_5_Struct: rb Enemy_Temp_Struct.size71EnemyShot_6_Struct: rb Enemy_Temp_Struct.size7375LevelData_Temp_Struct:76LevelData_Temp_Counter: rw 177LevelData_Temp_EnemyType: rb 178LevelData_Temp_Initial_X: rb 179LevelData_Temp_Delta_X_Initial_Addr: rw 180LevelData_Temp_EnemyNumber: rb 181LevelData_Temp_Struct.size: equ $ - LevelData_Temp_Struct8588LevelCounter: rw 190LevelData_CurrentAddr: rw 193Screen_Y_Origin: rb 1 96VerticalScroll: rb 197CurrentMegaROMPage: rb 198CurrentAddrLineScroll: rw 199CurrentVRAMAddrLineScroll: rw 1102104Debug_Temp_Byte: rb 1105Debug_Temp_Word: rw 1114117SpriteAttrTableBuffer: rb 32 * 4118.size: equ $ - SpriteAttrTableBuffer119Main.s213RamEnd: